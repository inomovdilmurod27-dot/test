<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<title>GTI va NS</title>
<style>

    
    /* BODY VA UMUMIY STIL */
    body { font-family:'Segoe UI','Roboto','Arial',sans-serif; background:#f4f6f8; margin:0; padding:0; line-height:1.6; color:#333; }
    
    /* HEADER STILI */
    header { background:#4a90e2; color:white; padding:20px; text-align:center; font-size:1.7em; font-weight:bold; box-shadow:0 2px 5px rgba(0,0,0,0.2);}    
    
    /* ASOSIY KONTEYNER */
    main { padding:25px; max-width:950px; margin:auto; }
    
    /* FORMA ELEMENTLARI STILI */
    label { font-weight:bold; margin-top:12px; display:block; font-size:1.05em;}
    select, input, textarea, button { width:100%; margin-top:6px; margin-bottom:12px; padding:10px; border-radius:8px; border:1px solid #ccc; font-size:1em; box-sizing:border-box; font-family:'Segoe UI','Roboto','Arial',sans-serif; }
    button { background-color:#4a90e2; color:white; border:none; cursor:pointer; font-weight:bold; transition:0.3s; font-size:1.05em; }
    button:hover { background-color:#357ab8; }
    textarea { min-height:180px; resize:vertical; font-size:1em; line-height:1.5; }
    
    /* MODAL (POPUP) STILI */
    .modal { display:none; position:fixed; z-index:999; left:0; top:0; width:100%; height:100%; overflow:auto; background-color: rgba(0,0,0,0.6); animation: fadeIn 0.4s; }
    .modal-content { background-color:#fff; margin:60px auto; padding:30px; border-radius:15px; border:1px solid #888; width:90%; max-width:950px; max-height:80%; overflow-y:auto; white-space:pre-wrap; font-family:'Segoe UI','Roboto','Arial',monospace; box-shadow:0 8px 25px rgba(0,0,0,0.3); animation: slideDown 0.4s ease; font-size:1em; line-height:1.5; }
    .close { color:#444; float:right; font-size:32px; font-weight:bold; cursor:pointer; transition:0.2s;}
    .close:hover { color:#000; }
    
    h2 { color:#333; margin-bottom:15px; font-size:1.3em; }
    
    /* SAVOLLAR VA JAVOBLAR BLOKLARI */
    .section { background:#fff; padding:25px; margin-bottom:25px; border-radius:12px; box-shadow:0 3px 8px rgba(0,0,0,0.1); }
    .question { background-color:#e6f0ff; margin-bottom:10px; padding:10px; border-radius:6px; transition:0.3s; font-size:1.05em; }
    .answer { background-color:#f0f0f0; margin-left:20px; padding:6px; border-radius:4px; margin-bottom:4px; font-size:1em; }
    .keyword { color:green; font-weight:bold; }
    .repeat { color:red; font-weight:bold; }
    #errorDiv { background:#fff3cd; border:1px solid #ffeeba; padding:15px; border-radius:8px; margin-top:15px; color:#856404; font-size:1em; }

    /* CLICKABLE XATOLIK ELEMENTLARI */
    .clickable-error { cursor:pointer; color:#d9534f; text-decoration:underline; }
    .highlight-question { background: yellow !important; }

    /* ANIMATSIYA */
    @keyframes slideDown { from {transform:translateY(-50px); opacity:0;} to {transform:translateY(0); opacity:1;} }
    @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }
</style>
</head>
<body>
    
<!-- RASMIY PAROL PANELI -->
<div id="passwordModal" style="position:fixed; top:0; left:0; width:100%; height:100%; background:#f5f5f5; z-index:9999; display:flex; justify-content:center; align-items:center;">
  <div style="width:400px; max-width:90%; text-align:center; padding:40px; border-radius:12px; background:#ffffff; color:#333; box-shadow:0 10px 30px rgba(0,0,0,0.15); animation: slideDown 0.5s ease; font-family:'Segoe UI',Arial,sans-serif;">
    <h2 style="margin-bottom:25px; font-size:1.5em; font-weight:bold; letter-spacing:0.5px;">Dasturga kirish</h2>
    <input type="password" id="passwordInput" placeholder="Parolni kiriting..." 
           style="width:100%; padding:12px; margin-bottom:20px; border-radius:6px; border:1px solid #ccc; font-size:1em; outline:none; transition:0.3s; background:#fefefe; color:#333;">
    <button id="loginBtn" 
            style="width:100%; padding:12px; border-radius:6px; border:none; background:#4a90e2; color:white; font-weight:bold; font-size:1em; cursor:pointer; transition:0.3s;">Kirish</button>
    <div id="passwordError" style="color:#d9534f; margin-top:15px; font-weight:bold; font-size:1em;"></div>
  </div>
</div>

<style>
@keyframes shake {
  0% { transform: translateX(0); }
  20% { transform: translateX(-6px); }
  40% { transform: translateX(6px); }
  60% { transform: translateX(-6px); }
  80% { transform: translateX(6px); }
  100% { transform: translateX(0); }
}
@keyframes slideDown { from {transform:translateY(-30px); opacity:0;} to {transform:translateY(0); opacity:1;} }

/* Hover effekt */
#loginBtn:hover { background:#357ab8; }

/* Input focus */
#passwordInput:focus { border-color:#4a90e2; box-shadow:0 0 8px rgba(74,144,226,0.4);}
</style>

<script>
const passwordModal = document.getElementById("passwordModal");
const passwordInput = document.getElementById("passwordInput");
const loginBtn = document.getElementById("loginBtn");
const errorDiv = document.getElementById("passwordError");

function checkPassword() {
    if(passwordInput.value === "9") {
        passwordModal.style.display = "none";
    } else {
        errorDiv.innerText = "Parol noto‚Äòg‚Äòri!";
        passwordInput.value = "";
        errorDiv.style.animation = "shake 0.5s";
        errorDiv.addEventListener("animationend", ()=>{ errorDiv.style.animation = ""; });
    }
}

// Enter tugmasi ishlaydi
passwordInput.addEventListener("keyup", function(event) {
    if(event.key === "Enter") loginBtn.click();
});

loginBtn.addEventListener("click", checkPassword);
</script>

    
<header>GTI va NS kafedrasi</header>
<main>
    <!-- SOZLAMALAR BO'LIMI -->
    <div class="section">
        <h2>Sozlamalar</h2>
        <label>Raqamlash:</label>
        <select id="numbering"><option value="yes">Ha</option><option value="no">Yo‚Äòq</option></select>

        <label>Variantlar (a, b, c‚Ä¶)</label>
        <select id="abcMode"><option value="yes">Ha</option><option value="no">Yo‚Äòq</option></select>

        <label>Savollar orasida bo‚Äòsh qator qo‚Äòyilsinmi?</label>
        <select id="addEnter"><option value="yes">Ha</option><option value="no">Yo‚Äòq</option></select>

        <label>Savol oldidagi belgi:</label>
        <input id="blockPrefix" value="++++">

        <label>To'g'ri javob oldidagi belgi:</label>
        <input id="firstPrefix" value="====#">

        <label>Noto'g'ri javob oldidagi belgi:</label>
        <input id="otherPrefix" value="====">
    </div>

    <!-- SAVOLLAR KIRITING -->
    <div class="section">
        <h2>Savollarni kiriting</h2>
        <textarea id="inputText" placeholder="Savollarni kiriting..."></textarea>
        <button onclick="showResult()">Natijani Ko‚Äòrish</button>
        <div id="errorDiv"></div>
    </div>
</main>


<div id="resultModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <div id="modalText"></div>
  </div>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<script>
/* --- 1. Qo‚Äòshimcha yordamchi funksiyalar --- */
function getABC(index){ return String.fromCharCode(97 + index) + ") "; }
function scrollToQuestion(index){
    let q = document.getElementById("q_" + index);
    if(!q) return;
    document.querySelectorAll('.highlight-question').forEach(e=>e.classList.remove('highlight-question'));
    q.classList.add('highlight-question');
    q.scrollIntoView({behavior:"smooth", block:"center"});
}

/* --- 2. Savol va javoblarni formatlash --- */
function customFormat(text, index, numbering, abcMode, blockPrefix, firstPrefix, otherPrefix){
    let lines = text.trim().split("\n");
    if(lines.length === 0) return [];

    let out = [];
    let title = lines[0];
    if(numbering === "yes") title = index + ". " + title;
    out.push(blockPrefix + title);

    for(let i=1; i<lines.length; i++){
        let line = lines[i];
        if(abcMode === "yes") line = getABC(i-1) + line;
        let prefix = (i === 1 ? firstPrefix : otherPrefix);
        out.push(prefix + line);
    }
    return out;
}

/* --- 3. Bloklarga bo‚Äòlish --- */
function splitBlocks(text){
    let lines = text.split("\n");
    let blocks = [], current = [];

    for(let i=0; i<lines.length; i++){
        let line = lines[i].trim();
        if(line === "") continue;
        if(line.endsWith("?") && current.length > 0){ blocks.push(current); current = [line]; }
        else current.push(line);
    }
    if(current.length>0) blocks.push(current);
    return blocks;
}

/* --- 4. Kalit so‚Äòzlarni aniqlash --- */
function extractKeywords(blocks){
    let keywordsMap = {};
    for(let i=0; i<blocks.length; i++){
        let firstAnswerI = blocks[i][1] ? blocks[i][1].split(/\s+/) : [];
        for(let j=0; j<blocks.length; j++){
            if(i===j) continue;
            let firstAnswerJ = blocks[j][1] ? blocks[j][1].split(/\s+/) : [];
            firstAnswerI.forEach(w1=>{
                firstAnswerJ.forEach(w2=>{
                    if(w1.toLowerCase()===w2.toLowerCase() && w1.length>2){
                        if(!keywordsMap[i]) keywordsMap[i] = new Set();
                        keywordsMap[i].add(w1);
                    }
                });
            });
        }
    }
    return keywordsMap;
}

function buildKeywordSignatures(keywordsMap){
    let sigMap = {};
    for(let idx in keywordsMap){
        let arr = Array.from(keywordsMap[idx]); 
        if(arr.length === 0) continue;
        // sort qilmaymiz, so‚Äòzlarni qo‚Äòlda kelgan tartibda saqlaymiz
        let signature = arr.join(" "); // bo‚Äòsh joy bilan ajratamiz
        if(!sigMap[signature]) sigMap[signature] = { indices: [], words: arr };
        sigMap[signature].indices.push(parseInt(idx)+1);
    }
    return sigMap;
}

/* --- 6. Takror javoblarni aniqlash --- */
function extractRepeatedAnswers(blocks){
    let result = {};
    blocks.forEach((blk,i)=>{
        let answers = blk.slice(1);
        let map = {};
        answers.forEach((val,index)=>{
            let key = val.trim().toLowerCase();
            if(map[key]) map[key].push(String.fromCharCode(97+index));
            else map[key] = [String.fromCharCode(97+index)];
        });
        for(let key in map){
            if(map[key].length > 1){
                if(!result[i]) result[i] = [];
                result[i].push({letters:map[key], value:key});
            }
        }
    });
    return result;
}

/* --- 7. Foiz hisoblash --- */
function calculatePercent(count, total){
    if(total === 0) return "0%";
    return Math.round((count/total)*100) + "%";
}



function showResult(){
    // 1Ô∏è‚É£ Inputni olish va sozlamalarni belgilash
    let input = document.getElementById("inputText").value.trim();
    let numbering = document.getElementById("numbering").value; // raqamlash
    let abcMode = document.getElementById("abcMode").value;     // a, b, c‚Ä¶
    let addEnter = document.getElementById("addEnter").value;   // savollar orasida bo‚Äòsh qator
    let blockPrefix = document.getElementById("blockPrefix").value;
    let firstPrefix = document.getElementById("firstPrefix").value;
    let otherPrefix = document.getElementById("otherPrefix").value;

    // 2Ô∏è‚É£ Savollarni bloklarga ajratish
    let blocks = splitBlocks(input);
    let modalDiv = document.getElementById("modalText");
    modalDiv.innerHTML = ""; // avvalgi natijani tozalash

    // 3Ô∏è‚É£ Turli tahlillar uchun massivlar
    let fewAnswer = [];   // 4 tadan kam javob
    let manyAnswer = [];  // 4 tadan ko‚Äòp javob
    let longAnswer = [];  // uzun javob (4+)

    // 4Ô∏è‚É£ Savollar va javoblarni modalga chiqarish
    blocks.forEach((blk,i)=>{
        // 4.1 Formatlash
        let formatted = customFormat(
            blk.join("\n"), 
            i+1, 
            numbering, abcMode, 
            blockPrefix, firstPrefix, otherPrefix
        );

        // 4.2 Savolni qo‚Äòshish
        let qDiv = document.createElement("div");
        qDiv.className = "question";
        qDiv.id = "q_" + (i+1);
        qDiv.innerHTML = formatted[0];
        modalDiv.appendChild(qDiv);

        // 4.3 Javoblarni qo‚Äòshish
        for(let j=1; j<formatted.length; j++){
            let aDiv = document.createElement("div");
            aDiv.className = "answer";
            aDiv.innerHTML = formatted[j];
            modalDiv.appendChild(aDiv);
        }

        // 4.4 Bo‚Äòsh qator qo‚Äòyish (agar kerak bo‚Äòlsa)
        if(addEnter === "yes" && i != blocks.length-1)
            modalDiv.appendChild(document.createElement("br"));

        // 4.5 Javoblar soni bo‚Äòyicha tahlil
        let numAnswers = blk.length - 1;
        if(numAnswers < 4) fewAnswer.push({text:(i+1)+". savol: "+blk[0], index:(i+1)});
        if(numAnswers > 4) manyAnswer.push({text:(i+1)+". savol: "+blk[0], index:(i+1)});
        if(numAnswers >= 4) longAnswer.push({text:(i+1)+". savol", index:(i+1)});
    });

    // 9Ô∏è‚É£ Takror savollar
    let questionMap = {};
    blocks.forEach((blk, index)=>{
        let qText = blk[0].trim();
        if(questionMap[qText]) questionMap[qText].push(index+1);
        else questionMap[qText] = [index+1];
    });
    let repeatedQuestions = [];
    for(let q in questionMap){ if(questionMap[q].length > 1) repeatedQuestions.push(questionMap[q]); }

    if(repeatedQuestions.length>0){
        let div = document.createElement("div");
        div.innerHTML = "<strong>Takror savollar:</strong><br>";
        repeatedQuestions.forEach(item=>{
            let nums = item.map(n=>`<span class='clickable-error' onclick='scrollToQuestion(${n})'>${n}</span>`).join(", ");
            div.innerHTML += nums + "<br>";
        });
        modalDiv.appendChild(div);
    }

    // 5Ô∏è‚É£ Takror javoblarni aniqlash
let repeatedAnswers = extractRepeatedAnswers(blocks);
if(Object.keys(repeatedAnswers).length > 0){
    let div = document.createElement("div");
    div.innerHTML = "<strong>Takror javoblar:</strong><br>";
    
    // Har bir savol bo‚Äòyicha
    for(let idx in repeatedAnswers){
        repeatedAnswers[idx].forEach(obj=>{
            // Raqam (variantlar) shaklida ko‚Äòrsatish
            let span = document.createElement("span");
            span.className = "clickable-error";
            span.innerText = `${parseInt(idx)+1} (${obj.letters.join(" va ")}); `;
            span.onclick = ()=>{ scrollToQuestion(parseInt(idx)+1); };
            div.appendChild(span);
        });
    }
    modalDiv.appendChild(div);
}


   // 6Ô∏è‚É£ 4 tadan kam javobli savollar
if(fewAnswer.length>0){
    let div = document.createElement("div");
    div.innerHTML = "<strong>4 tadan kam javobli savollar:</strong><br>";
    
    fewAnswer.forEach((item, idx) => {
        let span = document.createElement("span");
        span.className = "clickable-error";
        span.innerText = item.index;
        span.onclick = () => scrollToQuestion(item.index);
        div.appendChild(span);

        if(idx !== fewAnswer.length - 1) div.appendChild(document.createTextNode("; "));
        else div.appendChild(document.createTextNode(";"));
    });

    modalDiv.appendChild(div);
}

// 7Ô∏è‚É£ 4 tadan ko‚Äòp javobli savollar
if(manyAnswer.length>0){
    let div = document.createElement("div");
    div.innerHTML = "<strong>4 tadan ko‚Äòp javobli savollar:</strong><br>";

    manyAnswer.forEach((item, idx) => {
        let span = document.createElement("span");
        span.className = "clickable-error";
        span.innerText = item.index;
        span.onclick = () => scrollToQuestion(item.index);
        div.appendChild(span);

        if(idx !== manyAnswer.length - 1) div.appendChild(document.createTextNode("; "));
        else div.appendChild(document.createTextNode(";"));
    });

    modalDiv.appendChild(div);
}


   // 8Ô∏è‚É£ Uzun javobli savollar
if(longAnswer.length>0){
    let div = document.createElement("div");
    div.innerHTML = "<strong>Uzun javobli savollar:</strong><br>";

    // Raqamlarni nuqta-vergul bilan chiqaramiz, clickable qilamiz
    longAnswer.forEach((item, idx) => {
        let span = document.createElement("span");
        span.className = "clickable-error";
        span.innerText = item.index;
        span.onclick = () => scrollToQuestion(item.index);
        div.appendChild(span);

        // Oxirgi raqamdan keyin nuqta-vergul qo‚Äòymaymiz
        if(idx !== longAnswer.length - 1) div.appendChild(document.createTextNode("; "));
        else div.appendChild(document.createTextNode(";"));
    });

    modalDiv.appendChild(div);
}



    

// üîü Kalit so‚Äòzlar aniqlangan javoblar (guruhlangan)
let keywordsMap = extractKeywords(blocks);
let sigMap = buildKeywordSignatures(keywordsMap);

let kwCount = 0;
if(Object.keys(sigMap).length > 0){
    let groups = Object.keys(sigMap).map(sig=>{
        let arr = sigMap[sig].indices.slice().sort((a,b)=>a-b);
        return { signature: sig, indices: arr, words: sigMap[sig].words, minIndex: arr[0] };
    });
    groups.sort((a,b)=> a.minIndex - b.minIndex);

    let kwDiv = document.createElement("div");
    kwDiv.id="keywordDiv";
    kwDiv.innerHTML = "<strong>Kalit so'zlar aniqlangan javoblar (guruhlangan):</strong><br>";

    groups.forEach(g=>{
        // Raqamlarni nuqta-vergul bilan birlashtiramiz
        let indicesStr = g.indices.join("; ");
        let wordsStr = g.words.join(" ");  // <-- bu yerda vergul o‚Äòrniga bo‚Äòsh joy
        let span = document.createElement("span");
        span.className = "clickable-error";
        span.innerHTML = indicesStr + "; " + wordsStr;
        span.onclick = ()=>{ scrollToQuestion(g.indices[0]); };
        kwDiv.appendChild(span);
        kwDiv.appendChild(document.createElement("br"));
        kwCount++;
    });
    modalDiv.appendChild(kwDiv);
}



    // 1Ô∏è‚É£1Ô∏è‚É£ Kichik/bosh harflar tufayli shubhali javoblar
    let suspicious = [];
    blocks.forEach((blk,i)=>{
        if(blk.length < 2) return;
        let answers = blk.slice(1);
        let firstAnswer = answers[0];
        let countUpper = 0, countLower = 0;
        answers.forEach(a=>{
            if(a[0] === a[0].toUpperCase()) countUpper++;
            else countLower++;
        });
        let isSuspicious = false;
        if(countUpper === answers.length) isSuspicious = false;
        else if(
            (firstAnswer[0] === firstAnswer[0].toUpperCase() && countLower >= 3) ||
            (firstAnswer[0] === firstAnswer[0].toLowerCase() && countUpper === answers.length-1) ||
            (countUpper === 2 && countLower === 2)
        ) isSuspicious = true;
        if(isSuspicious) suspicious.push({text:(i+1)+". sav–æl: "+blk[0], index:(i+1)});
    });

    let suspiciousCount = suspicious.length;
    if(suspiciousCount>0){
        let susDiv = document.createElement("div");
        susDiv.innerHTML = "<strong>Kichik/bosh harflar tufayli shubhali javoblar:</strong><br>";
        susDiv.style.color = "orange";
        suspicious.forEach(item=>{
            susDiv.innerHTML += `<span class='clickable-error' onclick='scrollToQuestion(${item.index})'>${item.text}</span><br>`;
        });
        modalDiv.appendChild(susDiv);
    }

    // 1Ô∏è‚É£2Ô∏è‚É£ Foizlarni hisoblash va chiqarish
    let totalQuestions = blocks.length;
    let repeatedQuestionsCount = repeatedQuestions.length;
    let fewAnswerCount = fewAnswer.length;
    let manyAnswerCount = manyAnswer.length;
    let longAnswerCount = longAnswer.length;
    let repeatedAnswersCount = Object.keys(repeatedAnswers).length;

    let percentDiv = document.createElement("div");
    percentDiv.style.marginTop = "20px";
    percentDiv.style.padding = "12px";
    percentDiv.style.background = "#e9f7ef"; 
    percentDiv.style.border = "1px solid #c7e6d1";
    percentDiv.style.borderRadius = "10px";
    percentDiv.style.color = "#333"; 

    percentDiv.innerHTML = "<strong>Statistik Foizlar:</strong><br><br>" +
       "Savollar soni: " + totalQuestions + "/100%<br><br>" +
    "‚Ä¢ Takrorlangan savollar: " + repeatedQuestionsCount + "/" + calculatePercent(repeatedQuestionsCount, totalQuestions) + "<br>" +
    "‚Ä¢ 4 tadan kam javoblar: " + fewAnswerCount + "/" + calculatePercent(fewAnswerCount, totalQuestions) + "<br>" +
    "‚Ä¢ 4 tadan ko‚Äòp javoblar: " + manyAnswerCount + "/" + calculatePercent(manyAnswerCount, totalQuestions) + "<br>" +
    "‚Ä¢ Uzun javobli savollar: " + longAnswerCount + "/" + calculatePercent(longAnswerCount, totalQuestions) + "<br>" +
    "‚Ä¢ Kalit so'zlar aniqlangan javoblar (guruhlangan): " + kwCount + "/" + calculatePercent(kwCount, totalQuestions) + "<br>" +
    "‚Ä¢ Takror javoblar aniqlangan: " + repeatedAnswersCount + "/" + calculatePercent(repeatedAnswersCount, totalQuestions) + "<br>" +
    "‚Ä¢ Kichik/bosh harflar tufayli shubhali javoblar: " + suspiciousCount + "/" + calculatePercent(suspiciousCount, totalQuestions) + "<br>";

    modalDiv.appendChild(percentDiv);

    // 1Ô∏è‚É£3Ô∏è‚É£ Modalni ko‚Äòrsatish
    document.getElementById("resultModal").style.display = "block";
}


/* --- 8. Yuklab olish funktsiyasi --- */
function downloadResult(format){
    let modalDiv = document.getElementById("modalText");
    if(!modalDiv.innerHTML.trim()){ alert("Natija mavjud emas!"); return; }

    if(format === 'txt'){
        let lines = [];
        modalDiv.querySelectorAll(".question, .answer").forEach(el=>{ if(el.innerText.trim()!=="") lines.push(el.innerText.trim()); });
        let blob = new Blob([lines.join("\n")], { type:"text/plain;charset=utf-8" });
        let link = document.createElement("a"); 
        link.href = URL.createObjectURL(blob);
        link.download = "natija.txt"; 
        link.click();
    }
    else if(format === 'doc'){
        let docHtml = "<html><head><meta charset='UTF-8'></head><body>" + modalDiv.innerHTML + "</body></html>";
        let blob = new Blob([docHtml], { type:"application/msword" });
        let link = document.createElement("a"); 
        link.href = URL.createObjectURL(blob);
        link.download = "natija.doc"; 
        link.click();
    }
    else if(format === 'xlsx'){
        let wb = XLSX.utils.book_new(); 
        let rows = [];
        modalDiv.querySelectorAll(".question, .answer").forEach(el=>{ if(el.innerText.trim()!=="") rows.push([el.innerText.trim()]); });
        XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(rows), "Natija");
        XLSX.writeFile(wb, "natija.xlsx");
    }
}

/* --- 9. Modal yopish --- */
function closeModal(){ document.getElementById("resultModal").style.display = "none"; }
window.onclick = function(event){ if(event.target == document.getElementById("resultModal")) closeModal(); }
</script>



<div style="padding:25px; max-width:950px; margin:auto;">
    <button onclick="downloadResult('txt')">Yuklab olish (TXT)</button>
    <button onclick="downloadResult('doc')">Yuklab olish (DOC)</button>
    <button onclick="downloadResult('xlsx')">Yuklab olish (Excel)</button>
</div>
</body>
</html>















